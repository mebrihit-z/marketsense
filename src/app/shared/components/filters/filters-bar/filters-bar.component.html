<div class="filters-root">
    <div class="filters-container">
      <div class="filter-icon-container">
        <img src="assets/icons/filter-icon.svg" alt="Filter" class="filter-icon">
        <span class="filters-label">Filters:</span>
      </div>
      <div class="filters-list">
        <app-filter-dropdown
          title="Investor Region"
          [options]="investorRegionOptions"
          [selected]="state.investorRegion"
          (selectedChange)="onChange('investorRegion', $event)"
        ></app-filter-dropdown>

        <app-filter-dropdown
          title="Investor Type"
          [options]="investorTypeOptions"
          [selected]="state.investorType"
          (selectedChange)="onChange('investorType', $event)"
        ></app-filter-dropdown>

        <app-filter-dropdown
          title="Product Region"
          [options]="productRegionOptions"
          [selected]="state.productRegion"
          (selectedChange)="onChange('productRegion', $event)"
        ></app-filter-dropdown>

        <app-filter-dropdown
          title="Product Type"
          [options]="productTypeOptions"
          [selected]="state.productType"
          (selectedChange)="onChange('productType', $event)"
        ></app-filter-dropdown>

        <app-filter-dropdown
          title="Product Sub-Type"
          [groupedOptions]="productSubTypeOptions"
          [selected]="state.productSubType"
          (selectedChange)="onChange('productSubType', $event)"
        ></app-filter-dropdown>
      </div>
      <div class="clear-all-container">
        <button class="clear-all" (click)="clearAll()">Clear All Filters</button>
      </div>
    </div>
    <!-- Toggles Section -->
    <div class="toggles-container">
      <!-- AI Confidence Slider -->
      <div class="ai-confidence-container">
        <p class="ai-confidence-label">AI Confidence</p>
        <div class="slider-wrapper">
          <div class="slider-label">Low</div>
          <div class="slider-container" #sliderContainer
               (click)="onAIConfidenceTrackClick($event)"
               (touchend)="onAIConfidenceTrackClick($event)">
            <div class="slider-track">
              <div class="slider-dots">
                <div class="dot" *ngFor="let i of [1,2,3,4,5,6,7,8,9,10]"></div>
              </div>
              <div class="slider-track-background"></div>
              <div class="slider-track-active" 
                   [style.left.px]="getActiveTrackLeft()" 
                   [style.width.px]="getActiveTrackWidth()"></div>
            </div>
            <div class="slider-knob slider-knob-min" 
                 [style.left.px]="getKnobPosition('min')"
                 (mousedown)="startDrag($event, 'min')"
                 (touchstart)="startDrag($event, 'min')"
                 (click)="$event.stopPropagation()"></div>
            <div class="slider-knob slider-knob-max" 
                 [style.left.px]="getKnobPosition('max')"
                 (mousedown)="startDrag($event, 'max')"
                 (touchstart)="startDrag($event, 'max')"
                 (click)="$event.stopPropagation()"></div>
          </div>
          <div class="slider-label">High</div>
        </div>
      </div>
      <!-- Data Type Toggle -->
      <div class="toggle-group">
        <label class="toggle-label">Data Type:</label>
        <div class="toggle-buttons">
          <button 
            class="toggle-btn" 
            [class.active]="dataType === 'historical'"
            (click)="setDataType('historical')">
            Historical
          </button>
          <button 
            class="toggle-btn" 
            [class.active]="dataType === 'forecasted'"
            (click)="setDataType('forecasted')">
            Forecasted
          </button>
        </div>
      </div>

      <!-- Time Horizon Range Slider -->
      <div class="time-horizon-container">
        <label class="toggle-label">Time Horizon:</label>
        <div class="time-horizon-slider-wrapper">
          <div class="time-horizon-slider-container" #timeHorizonSliderContainer
               (click)="onTimeHorizonTrackClick($event)"
               (touchend)="onTimeHorizonTrackClick($event)">
            <div class="time-horizon-slider-track">
              <div class="time-horizon-dots">
                <div class="dot" *ngFor="let horizon of timeHorizons; let i = index" 
                     [style.left.%]="(i / (timeHorizons.length - 1)) * 100"></div>
              </div>
              <div class="time-horizon-track-background"></div>
              <div class="time-horizon-track-active" 
                   [style.left.px]="getTimeHorizonActiveTrackLeft()" 
                   [style.width.px]="getTimeHorizonActiveTrackWidth()"></div>
            </div>
            <div class="time-horizon-handle time-horizon-handle-start" 
                 [style.left.px]="getTimeHorizonHandlePosition('start')"
                 (mousedown)="startTimeHorizonDrag($event, 'start')"
                 (touchstart)="startTimeHorizonDrag($event, 'start')"
                 (click)="$event.stopPropagation()"></div>
            <div class="time-horizon-handle time-horizon-handle-end" 
                 [style.left.px]="getTimeHorizonHandlePosition('end')"
                 (mousedown)="startTimeHorizonDrag($event, 'end')"
                 (touchstart)="startTimeHorizonDrag($event, 'end')"
                 (click)="$event.stopPropagation()"></div>
          </div>
          <div class="time-horizon-labels">
            <span class="time-horizon-label" 
                  *ngFor="let horizon of timeHorizons; let i = index"
                  [style.left.%]="(i / (timeHorizons.length - 1)) * 100"
                  [style.transform]="'translateX(-50%)'">
              {{ horizon }}
            </span>
          </div>
        </div>
      </div>
    </div>
</div>
