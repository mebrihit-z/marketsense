<div class="asset-flows-container">
  <!-- Header Section -->
  <div class="header-section">
    <!-- Left: Title and Button -->
    <div class="title-container">
      <div class="title-row">
        <h2 class="title">Asset Flows</h2>
        <button class="streamgraph-btn" (click)="onStreamgraphClick()">
          <img src="assets/icons/streamgraph-icon.svg" alt="Streamgraph">
          <span>Streamgraph</span>
        </button>
      </div>
      <p class="subtitle">Aggregated asset flows across selected categories</p>
    </div>

    <!-- Right: Controls -->
    <div class="controls-section">
      <!-- Data View Toggle -->
      <div class="control-group">
        <label class="control-label">Data View:</label>
        <div class="toggle-group">
          <button 
            class="toggle-btn"
            [class.active]="dataView === 'cumulative'"
            (click)="setDataView('cumulative')">
            Cumulative
          </button>
          <button 
            class="toggle-btn"
            [class.active]="dataView === 'pointInTime'"
            (click)="setDataView('pointInTime')">
            Point in Time
          </button>
        </div>
      </div>

      <!-- Time Horizon Selector -->
      <div class="control-group">
        <label class="control-label">Time Horizon:</label>
        <div class="time-horizon-group">
          <button 
            *ngFor="let horizon of timeHorizons"
            class="horizon-btn"
            [class.active]="selectedTimeHorizon === horizon"
            (click)="setTimeHorizon(horizon)">
            {{ horizon }}
          </button>
        </div>
      </div>

      <!-- More Options Button -->
      <button class="more-options-btn" aria-label="More options">
        <img src="assets/icons/more-options-icon.svg" alt="More options">
      </button>
    </div>
  </div>

  <!-- Flow Dimensions & Toggle Section -->
  <div class="dimensions-section">
    <!-- Flow Dimensions -->
    <div class="dimensions-container">
      <p class="dimensions-label">Flow Dimensions (Drag to reorder)</p>
      <div class="dimensions-chips">
        <div 
          *ngFor="let dimension of flowDimensions" 
          class="dimension-chip"
          [class.active]="dimension.active">
          <img src="assets/icons/nimbus-drag-dots.svg" alt="Drag" class="drag-icon">
          <span class="chip-text">
            {{ dimension.label }} 
            <ng-container *ngIf="dimension.count > 0">({{ dimension.count }})</ng-container>
            <ng-container *ngIf="dimension.count === 0">(All Types)</ng-container>
          </span>
        </div>
      </div>
    </div>

    <!-- Product Sub-Types Toggle -->
    <div class="toggle-container">
      <div class="switch-wrapper">
        <label class="switch">
          <input type="checkbox" [checked]="showProductSubTypes" (change)="toggleProductSubTypes()">
          <span class="slider"></span>
        </label>
        <span class="toggle-label">Show Product Sub-Types</span>
      </div>
    </div>
  </div>

  <!-- Sankey Diagram Visualization -->
  <div class="visualization-container">
    <app-sankey-diagram></app-sankey-diagram>
    <!-- Legend -->
    <div class="legend">
      <div class="legend-item">
        <div class="legend-color inflow"></div>
        <span class="legend-text">Inflow</span>
      </div>
      <div class="legend-item">
        <div class="legend-color outflow"></div>
        <span class="legend-text">Outflow</span>
      </div>
    </div>
  </div>
</div>
